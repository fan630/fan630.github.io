<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"fan630.github.io","root":"/","scheme":"Pisces","version":"7.7.2","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"flat"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="ç¬¬ä¸€æ¬¡çœ‹åˆ°promiseçš„å¯¦æˆ°, æ˜¯å‡ºç¾åœ¨å£ç½©åœ°åœ–çš„ç¤ºç¯„ç¢¼, ç•¶æ™‚è€å¸«é€épromiseè¼‰å…¥å…©å€‹ajax. è‡ªå·±ä¹‹å‰ä¹Ÿæœ‰å¯«äº†ä¸€ç¯‡æ–‡ç« åœ¨è¬›ç›¸é—œçš„æ¦‚å¿µ, ä½†æ˜¯è¦ºå¾—é‚„æ˜¯æ²’æœ‰æŒæ¡å¥½.">
<meta property="og:type" content="article">
<meta property="og:title" content="ä¸€æ¬¡ææ‡‚Promise">
<meta property="og:url" content="http://fan630.github.io/uncategorized/2020/02/20/Promise-you-need-to-know/index.html">
<meta property="og:site_name" content="æ“´å……æµ·é¦¬è¿´çš„ç™¾å¯¶ç®±">
<meta property="og:description" content="ç¬¬ä¸€æ¬¡çœ‹åˆ°promiseçš„å¯¦æˆ°, æ˜¯å‡ºç¾åœ¨å£ç½©åœ°åœ–çš„ç¤ºç¯„ç¢¼, ç•¶æ™‚è€å¸«é€épromiseè¼‰å…¥å…©å€‹ajax. è‡ªå·±ä¹‹å‰ä¹Ÿæœ‰å¯«äº†ä¸€ç¯‡æ–‡ç« åœ¨è¬›ç›¸é—œçš„æ¦‚å¿µ, ä½†æ˜¯è¦ºå¾—é‚„æ˜¯æ²’æœ‰æŒæ¡å¥½.">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://images.unsplash.com/photo-1550063873-ab792950096b?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=400&q=80">
<meta property="og:image" content="http://fan630.github.io/uncategorized/2020/02/20/Promise-you-need-to-know/webAPI.png">
<meta property="og:image" content="http://fan630.github.io/uncategorized/2020/02/20/Promise-you-need-to-know/promise.png">
<meta property="og:image" content="http://fan630.github.io/uncategorized/2020/02/20/Promise-you-need-to-know/new_promise.png">
<meta property="og:image" content="http://fan630.github.io/uncategorized/2020/02/20/Promise-you-need-to-know/img-promise-pending.png">
<meta property="og:image" content="http://fan630.github.io/uncategorized/2020/02/20/Promise-you-need-to-know/resolve_fail.png">
<meta property="og:image" content="http://fan630.github.io/uncategorized/2020/02/20/Promise-you-need-to-know/Promise_resolve.png">
<meta property="og:image" content="http://fan630.github.io/uncategorized/2020/02/20/Promise-you-need-to-know/async.png">
<meta property="article:published_time" content="2020-02-20T05:30:55.000Z">
<meta property="article:modified_time" content="2020-03-05T05:42:52.785Z">
<meta property="article:author" content="Norris">
<meta property="article:tag" content="javascript">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://images.unsplash.com/photo-1550063873-ab792950096b?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=400&q=80">

<link rel="canonical" href="http://fan630.github.io/uncategorized/2020/02/20/Promise-you-need-to-know/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>ä¸€æ¬¡ææ‡‚Promise | æ“´å……æµ·é¦¬è¿´çš„ç™¾å¯¶ç®±</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ›å°èˆªæ¬„">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">æ“´å……æµ·é¦¬è¿´çš„ç™¾å¯¶ç®±</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">å±’å‹äºº</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>é¦–é </a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>æ¨™ç±¤</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>åˆ†é¡</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>æ­¸æª”</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœå°‹
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="æœå°‹..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://fan630.github.io/uncategorized/2020/02/20/Promise-you-need-to-know/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Norris">
      <meta itemprop="description" content="æ¯å¤©éƒ½è¦é€²æ­¥ä¸€é»é»">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ“´å……æµ·é¦¬è¿´çš„ç™¾å¯¶ç®±">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ä¸€æ¬¡ææ‡‚Promise
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">ç™¼è¡¨æ–¼</span>

              <time title="å‰µå»ºæ™‚é–“ï¼š2020-02-20 13:30:55" itemprop="dateCreated datePublished" datetime="2020-02-20T13:30:55+08:00">2020-02-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°æ–¼</span>
                <time title="ä¿®æ”¹æ™‚é–“ï¼š2020-03-05 13:42:52" itemprop="dateModified" datetime="2020-03-05T13:42:52+08:00">2020-03-05</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/uncategorized/2020/02/20/Promise-you-need-to-know/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="uncategorized/2020/02/20/Promise-you-need-to-know/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><img src="https://images.unsplash.com/photo-1550063873-ab792950096b?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=400&q=80" alt=""></p>
<p>ç¬¬ä¸€æ¬¡çœ‹åˆ°promiseçš„å¯¦æˆ°, æ˜¯å‡ºç¾åœ¨å£ç½©åœ°åœ–çš„ç¤ºç¯„ç¢¼, ç•¶æ™‚è€å¸«é€épromiseè¼‰å…¥å…©å€‹ajax. è‡ªå·±ä¹‹å‰ä¹Ÿæœ‰å¯«äº†ä¸€ç¯‡æ–‡ç« åœ¨è¬›ç›¸é—œçš„æ¦‚å¿µ, ä½†æ˜¯è¦ºå¾—é‚„æ˜¯æ²’æœ‰æŒæ¡å¥½.</p>
<a id="more"></a>
<p>çŸ¥é“ä»€éº¼æ™‚å€™è¦ç”¨æ˜¯ä¸€å›äº‹, ä½†æ˜¯æ€éº¼ç”¨åˆæ˜¯ä¸€å›äº‹, é‚„æœ‰å°±æ˜¯ç‚ºä»€éº¼è¦ç”¨? æ‰€ä»¥å¯«äº†é€™ç¯‡æ–‡ç« , å¸Œæœ›èƒ½å¾¹åº•äº†è§£Promise, async, await. </p>
<p>ï¼ˆæ­¤ç¯‡æ–‡ç« æ˜¯ä»¥ç­†è€…çš„ç†è§£åŠ ä»¥æ’°å¯«,æ‰€ä»¥åŸºç¤è§€å¿µå¾ˆå¤šéƒ½è·³é, ä¸é©åˆåŸºç¤è€…é–±è®€)</p>
<h2 id="JSçš„é‹ä½œåŸç†"><a href="#JSçš„é‹ä½œåŸç†" class="headerlink" title="JSçš„é‹ä½œåŸç†"></a>JSçš„é‹ä½œåŸç†</h2><p>JSæœ¬èº«æ˜¯å–®åŸ·è¡Œç·’, ä¹Ÿå°±æ˜¯ä¸€æ¬¡åªèƒ½è™•ç†ä¸€ä»¶äº‹çš„èªè¨€,  ä½†ç¨‹å¼è¦è™•ç†çš„äº‹æƒ…å¾ˆå¤š, å–®åŸ·è¡Œç·’ä¸å¤ªå¤ ç”¨å•Š, æ€éº¼è¾¦?</p>
<blockquote>
<p><em>é‚£å°±è¦çµ¦å„ªå…ˆé †åº</em></p>
</blockquote>
<p>JSæ©Ÿåˆ¶æ˜¯æœƒæŠŠéåŒæ­¥äº‹ä»¶ç§»å‹•åˆ°æœ€å¾Œé¢åŸ·è¡Œ<br>å“ªäº›æ˜¯éåŒæ­¥äº‹ä»¶å‘¢? </p>
<p><img src="webAPI.png" alt=""></p>
<h2 id="åè©è§£é‡‹"><a href="#åè©è§£é‡‹" class="headerlink" title="åè©è§£é‡‹"></a>åè©è§£é‡‹</h2><p>ç°¡å–®äº†è§£äº†JSé‹ä½œåŸç†, ä¸å…ä¿—çš„å…ˆä¾†å€‹åè©è§£é‡‹.</p>
<h3 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h3><p>æ˜¯ä¸€å€‹æŠ€è¡“åç¨±  â‡’ å–å¾—é ç«¯è³‡æ–™çš„éåŒæ­¥è¡Œç‚º</p>
<p>ç‚ºä»€éº¼æ˜¯<em>éåŒæ­¥</em>?<br>å•é€™å•é¡Œå…ˆå‡è¨­å¦‚æœæ˜¯åŒæ­¥, è€Œé ç«¯çš„è³‡æ–™åˆå¤šåˆé›œ,åˆè¦å…ˆè™•ç†çš„è©±, é‚£æ•´å€‹ç¨‹å¼éƒ½å¡åœ¨é‚£</p>
<p>ä»¥æœ€è¿‘æœ€å¤¯çš„è²·é…’ç²¾ç‚ºä¾‹: </p>
<p>åŸæœ¬è¦çµå¸³çš„æ²’è¾¦æ³•çµå¸³, å¦‚æœå…ˆç­‰æ’éšŠè²·é…’ç²¾çš„äººéƒ½çµå¸³å®Œ, æ‰è™•ç†å¾Œé¢çš„çµå¸³, é‚£é€™æ¨£æ˜¯ä¸€ä»¶æ²’æœ‰æ•ˆç‡çš„äº‹æƒ…. </p>
<p>é‚£æ€éº¼è¾¦?  </p>
<p>å…ˆè™•ç†çµå¸³çš„å®¢æˆ¶, è²·é…’ç²¾çš„äººç¹¼çºŒæ’éšŠ. ç­‰åˆ°å¾Œé¢çµå¸³çš„äººéƒ½æ²’äººäº†, å†ä¾†è™•ç†é…’ç²¾çš„çµå¸³. </p>
<h3 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h3><p>æ˜¯ä¸€å€‹èªæ³• â‡’ è™•ç†éåŒæ­¥è¡Œç‚º<br>ç‚ºä»€éº¼è¦ç”¨ â‡’ å› ç‚ºè¦æœ‰ä¸€å€‹æ¨™æº–åŒ–çš„ä»‹é¢<br>ç™½è©±ä¸€é»: é€éPromiseç®¡ç†ajaxè¡Œç‚º, Promiseæ˜¯ç”¨ä¾†æ”¹å–„ JavaScript éåŒæ­¥çš„èªæ³•ã€‚</p>
<p>å†ç™½è©±ä¸€é»: æˆ‘è¦æ€éº¼ç®¡ç†æ’éšŠçš„äººæ½®æ‹‰?</p>
<h3 id="Promise-èˆ‡-Asyncã€Await-æœ‰ä»€éº¼é—œä¿‚ï¼Ÿ"><a href="#Promise-èˆ‡-Asyncã€Await-æœ‰ä»€éº¼é—œä¿‚ï¼Ÿ" class="headerlink" title="Promise èˆ‡ Asyncã€Await æœ‰ä»€éº¼é—œä¿‚ï¼Ÿ"></a>Promise èˆ‡ Asyncã€Await æœ‰ä»€éº¼é—œä¿‚ï¼Ÿ</h3><p>Asyncã€Await å¯ä»¥åŸºæ–¼ Promise è®“éåŒæ­¥çš„èªæ³•çš„çµæ§‹é¡ä¼¼æ–¼ â€œåŒæ­¥èªè¨€â€ï¼Œæ›´æ˜“è®€ä¸”å¥½ç®¡ç†ã€‚</p>
<p>ç™½è©±ä¸€é»: å„ªåŒ–promiseçš„å­¿ç”Ÿå…„å¼Ÿ<br>å†ç™½è©±ä¸€é»: æ¯”åŸæœ¬Promiseæ–¹æ³•æ›´å¥½çš„ä½œæ³•</p>
<h2 id="Promise-çš„çµæ§‹åŠç‹€æ…‹"><a href="#Promise-çš„çµæ§‹åŠç‹€æ…‹" class="headerlink" title="Promise çš„çµæ§‹åŠç‹€æ…‹"></a>Promise çš„çµæ§‹åŠç‹€æ…‹</h2><h3 id="åŸç”Ÿèª¿ç”¨"><a href="#åŸç”Ÿèª¿ç”¨" class="headerlink" title="åŸç”Ÿèª¿ç”¨"></a>åŸç”Ÿèª¿ç”¨</h3><p>é‚£å¦‚æœconsole.dir(Promise) æœƒå‡ºç¾ä»€éº¼å‘¢?</p>
<p><img src="promise.png" alt=""></p>
<p>Promise æœ¬èº«æ˜¯ä¸€å€‹å»ºæ§‹å‡½å¼ï¼Œå‡½å¼ä¹Ÿæ˜¯å±¬æ–¼ç‰©ä»¶çš„ä¸€ç¨®ï¼Œå› æ­¤å¯ä»¥é™„åŠ å…¶å®ƒå±¬æ€§æ–¹æ³•åœ¨ä¸Šï¼Œé€é console çš„çµæœå¯ä»¥çœ‹åˆ° Promise å¯ä»¥ç›´æ¥ä½¿ç”¨ allã€raceã€resolveã€reject çš„æ–¹æ³•</p>
<ul>
<li>Promise.all</li>
<li>Promise.race</li>
<li>Promise.resolve</li>
<li>Promise.reject</li>
</ul>
<p>(è‹¥æƒ³äº†è§£ç”¨æ³•, å¯ä»¥ç›´æ¥åƒè€ƒæ®µè½Promiseæ–¹æ³•)</p>
<hr>
<p>Promise å»ºæ§‹å‡½å¼çš„åŒæ™‚ï¼Œå¿…é ˆå‚³å…¥ä¸€çµ„å‡½å¼ä½œç‚ºåƒæ•¸ï¼Œæ­¤å‡½å¼çš„åƒæ•¸åŒ…å«<code>resolve</code>, <code>reject</code>ï¼Œé€™å…©å€‹æ–¹æ³•åˆ†åˆ¥ä»£è¡¨æˆåŠŸèˆ‡å¤±æ•—çš„å›å‚³çµæœï¼Œç‰¹åˆ¥æ³¨æ„<strong>é€™å…©å€‹åƒ…èƒ½å›å‚³å…¶ä¸­ä¹‹ä¸€</strong>ï¼Œä¸”<strong>å¿…å®šåªèƒ½å›å‚³ä¸€æ¬¡</strong>ã€‚<strong>å›å‚³å¾Œè¡¨ç¤ºæ­¤ Promise äº‹ä»¶çµæŸ</strong></p>
<h3 id="å»ºæ§‹å‡½å¼-new-èª¿ç”¨"><a href="#å»ºæ§‹å‡½å¼-new-èª¿ç”¨" class="headerlink" title="å»ºæ§‹å‡½å¼ new èª¿ç”¨"></a>å»ºæ§‹å‡½å¼ new èª¿ç”¨</h3><p>å…ˆä¾†çœ‹å…©ç¨®èª¿ç”¨çš„æ–¹æ³•</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨å‡½æ•¸è£¡é¢çš„å¯«æ³•</span></span><br><span class="line"><span class="keyword">const</span> promise2 = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.dir(promise2())</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸€èˆ¬èª¿ç”¨</span></span><br><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span> &#123;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.dir(p)</span><br></pre></td></tr></table></figure>

<p>é‚£å¦‚æœconsole.dir(p) æœƒå‡ºç¾ä»€éº¼å‘¢?</p>
<p><img src="new_promise.png" alt=""></p>
<p>Promise å»ºæ§‹å‡½å¼ new å‡ºçš„ç‰©ä»¶ï¼Œå‰‡å¯ä»¥ä½¿ç”¨å…¶ä¸­çš„åŸå‹æ–¹æ³•, ï¼ˆåœ¨ prototype å…§ï¼Œå…¶ä¸­å°±åŒ…å« thenã€catchã€finallyï¼Œé€™äº›æ–¹æ³•å‰‡å¿…é ˆåœ¨æ–°ç”¢ç”Ÿçš„ç‰©ä»¶ä¸‹æ‰èƒ½å‘¼å«ã€‚</p>
<ul>
<li>p.then()    =&gt; Promise å›å‚³æ­£ç¢º</li>
<li>p.catch()   =&gt; Promise å›å‚³å¤±æ•—</li>
<li>p.finally()   =&gt; éåŒæ­¥åŸ·è¡Œå®Œç•¢</li>
</ul>
<h2 id="ç‹€æ…‹"><a href="#ç‹€æ…‹" class="headerlink" title="ç‹€æ…‹"></a>ç‹€æ…‹</h2><p>åœ¨ Promise çš„åŸ·è¡Œå‡½å¼ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ä»¥ä¸‹å…©å€‹å±¬æ€§ï¼š</p>
<ul>
<li><em>[[PromiseStatus]]</em>: <code>&quot;pending&quot;</code> -&gt; è¡¨ç¤ºç›®å‰çš„é€²åº¦ç‹€æ…‹</li>
<li><em>[[PromiseValue]]</em>: <code>undefined</code> -&gt; è¡¨ç¤º <code>resolve</code> æˆ– <code>reject</code> å›å‚³çš„å€¼</li>
</ul>
<p><img src="img-promise-pending.png" alt=""></p>
<p>Promise ä¸­æœƒä½¿ç”¨ resolve æˆ– reject å›å‚³çµæœï¼Œä¸¦åœ¨èª¿ç”¨æ™‚ä½¿ç”¨ then æˆ– catch å–å¾—å€¼ã€‚</p>
<h3 id="æ›´æ”¹ç‹€æ…‹çœ‹çœ‹"><a href="#æ›´æ”¹ç‹€æ…‹çœ‹çœ‹" class="headerlink" title="æ›´æ”¹ç‹€æ…‹çœ‹çœ‹"></a>æ›´æ”¹ç‹€æ…‹çœ‹çœ‹</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise2 = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">          resolve(<span class="string">'å¤±æ•—'</span>);</span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.dir(promise2())</span><br></pre></td></tr></table></figure>
<p><img src="resolve_fail.png" alt=""></p>
<h3 id="then-vs-catch-èˆ‰ä¾‹"><a href="#then-vs-catch-èˆ‰ä¾‹" class="headerlink" title="then vs catch èˆ‰ä¾‹"></a>then vs catch èˆ‰ä¾‹</h3><p>ä¸Šåˆ—çš„ä¸‰ç¨®ç‹€æ…‹æ¯æ¬¡åŸ·è¡Œå¿…å®šæœƒç¶“é Pendingï¼Œæ¥ä¸‹ä¾†é€²å…¥ Fulfilled æˆ– Rejected çš„å…¶ä¸­ä¹‹ä¸€ï¼Œä¸¦ä¸”å¯ä»¥ä½¿ç”¨ then() åŠ catch() å–å¾—æˆåŠŸæˆ–å¤±æ•—çš„çµæœã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">	<span class="comment">// é€™ä¸€æ­¥åªæ˜¯æ”¹è®ŠPromiseValue, ä½†é‚„ä¸èƒ½èª¿ç”¨</span></span><br><span class="line">    resolve(<span class="number">3</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">a.then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(result); <span class="comment">//3</span></span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'å¤±æ•—'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>Promise å¦ä¸€å€‹ç‰¹é»åœ¨æ–¼ thenã€catch éƒ½å¯ä»¥ä½¿ç”¨éˆæ¥çš„æ–¹å¼ä¸æ–·çš„é€²è¡Œä¸‹ä¸€å€‹ä»»å‹™.</strong></p>
<h2 id="å¯¦ä¾‹ä¾†ä¸€ä¸‹"><a href="#å¯¦ä¾‹ä¾†ä¸€ä¸‹" class="headerlink" title="å¯¦ä¾‹ä¾†ä¸€ä¸‹"></a>å¯¦ä¾‹ä¾†ä¸€ä¸‹</h2><p>ç­†è€…é€™é‚Šæœ‰æ‰¾åˆ°ä¸€å€‹å¾ˆå¥½çš„ç¯„ä¾‹ä¾†è§£é‡‹</p>
<ul>
<li>ç‚ºä»€éº¼è¦ç”¨?</li>
<li>æ€éº¼ç”¨? çŸ¥é“æœ‰é€™å€‹æ­¦å™¨æ˜¯ç†æ‰€ç•¶ç„¶, ä½†æ˜¯ä»€éº¼æ™‚å€™è¦æŠŠé€™æ­¦å™¨å«å‡ºä¾†? </li>
</ul>
<p>é¦–å…ˆæˆ‘è¦å¯ä»¥å°å‡ºA â‡’ B â‡’ Cçš„é †åº</p>
<h3 id="ç„¡æ³•ç¢ºå®šcallbackå›å‚³çš„é †åº"><a href="#ç„¡æ³•ç¢ºå®šcallbackå›å‚³çš„é †åº" class="headerlink" title="ç„¡æ³•ç¢ºå®šcallbackå›å‚³çš„é †åº"></a>ç„¡æ³•ç¢ºå®šcallbackå›å‚³çš„é †åº</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logWord</span>(<span class="params">word</span>)</span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(word)</span><br><span class="line">    &#125;, <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">100</span>) + <span class="number">1</span></span><br><span class="line">    <span class="comment">// return value between 1 ~ 100</span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logAll</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    logWord(<span class="string">"A"</span>)</span><br><span class="line">    logWord(<span class="string">"B"</span>)</span><br><span class="line">    logWord(<span class="string">"C"</span>)</span><br><span class="line">&#125;</span><br><span class="line">logAll()</span><br></pre></td></tr></table></figure>

<h3 id="æ”¹æˆcallback"><a href="#æ”¹æˆcallback" class="headerlink" title="æ”¹æˆcallback"></a>æ”¹æˆcallback</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logWord</span>(<span class="params">word, callback</span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(word)</span><br><span class="line">        callback()</span><br><span class="line">    &#125;), <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">100</span>) + <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logAll</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    logWord(<span class="string">"A"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        logWord(<span class="string">"B"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            logWord(<span class="string">"C"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Callback Hell</span></span><br><span class="line">logAll()</span><br></pre></td></tr></table></figure>
<h3 id="æ”¹æˆPromise"><a href="#æ”¹æˆPromise" class="headerlink" title="æ”¹æˆPromise"></a>æ”¹æˆPromise</h3><p>ç°¡å–®ä¾†èªªå°±æ˜¯åœ¨éåŒæ­¥äº‹ä»¶ä¸Šåœ¨å¤–é¢åŒ…è£ä¸€å±¤</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logWord</span>(<span class="params">word</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                resolve()</span><br><span class="line">                <span class="built_in">console</span>.log(word)</span><br><span class="line">            &#125;, <span class="built_in">Math</span>.random()*<span class="number">100</span> + <span class="number">1</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logAll</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    logWord(<span class="string">'C'</span>)</span><br><span class="line">        <span class="comment">// é€™æ˜¯çœç•¥returnçš„å¯«æ³•</span></span><br><span class="line">        .then(<span class="function"><span class="params">success</span> =&gt;</span> logWord(<span class="string">'B'</span>))</span><br><span class="line">        .then(<span class="function"><span class="params">success</span> =&gt;</span> logWord(<span class="string">'A'</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">logAll() <span class="comment">// æœ‰é †åºæ€§çš„çš„è™•ç†  C =&gt; B =&gt; A</span></span><br></pre></td></tr></table></figure>

<h3 id="æ”¹æˆAsync-amp-Await-å¯«æ³•"><a href="#æ”¹æˆAsync-amp-Await-å¯«æ³•" class="headerlink" title="æ”¹æˆAsync &amp; Await å¯«æ³•"></a>æ”¹æˆAsync &amp; Await å¯«æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logWord</span>(<span class="params">word</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                resolve()</span><br><span class="line">                <span class="built_in">console</span>.log(word)</span><br><span class="line">            &#125;, <span class="built_in">Math</span>.random()*<span class="number">100</span> + <span class="number">1</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// async å’Œ await å°±æ˜¯æŠŠåŸæœ¬çš„thençµ¦å–ä»£, è®“åŸæœ¬æ˜¯éåŒæ­¥çš„äº‹ä»¶è™•ç†èµ·ä¾†åƒæ˜¯åŒæ­¥ä¸€æ¨£, ç¨‹å¼ç¢¼ä¸€è¡Œä¸€è¡Œå¾€ä¸‹çœ‹</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">logAll</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">await</span> logWord(<span class="string">'C'</span>)</span><br><span class="line">    <span class="keyword">await</span> logWord(<span class="string">'B'</span>)</span><br><span class="line">    <span class="keyword">await</span> logWord(<span class="string">'A'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">logAll()  <span class="comment">// æœ‰é †åºæ€§çš„çš„è™•ç†  C =&gt; B =&gt; A</span></span><br></pre></td></tr></table></figure>


<h2 id="Promise-æ–¹æ³•"><a href="#Promise-æ–¹æ³•" class="headerlink" title="Promise æ–¹æ³•"></a>Promise æ–¹æ³•</h2><p>å±•é–‹å¾Œå¯ä»¥çœ‹åˆ°ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<ul>
<li>all -&gt; å¤šå€‹ Promise è¡Œç‚ºåŒæ™‚åŸ·è¡Œï¼Œå…¨éƒ¨å®Œæˆå¾Œçµ±ä¸€å›å‚³ã€‚</li>
<li>race -&gt; å¤šå€‹ Promise åŒæ™‚åŸ·è¡Œï¼Œä½†åƒ…å›å‚³ç¬¬ä¸€å€‹å®Œæˆçš„ã€‚</li>
<li>Promise.reject, Promise.resolve -&gt; å®šç¾© Fulfilled æˆ– Rejected çš„ Promise ç‰©ä»¶ã€‚</li>
</ul>
<p>é€™é‚Šå…ˆå®šç¾©ä¸€å€‹å‡½å¼, ç‚ºå¾ŒçºŒä¾‹å­æ‰€ç”¨</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">promise</span>(<span class="params">num, time=<span class="number">500</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            num ? resolve(<span class="string">`<span class="subst">$&#123;num&#125;</span>`</span>,<span class="string">'æˆåŠŸ'</span>):reject(<span class="string">'å¤±æ•—'</span>)</span><br><span class="line">        &#125;, time);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Promise-all"><a href="#Promise-all" class="headerlink" title="Promise.all"></a>Promise.all</h3><blockquote>
<p>é³´æ§èµ·è·‘, å…¨éƒ¨ä¸€èµ·è·‘, æ¯”è³½ä»€éº¼æ™‚å€™çµæŸ? å…¨éƒ¨çš„é¦¬è·‘å®Œæ‰æœƒçµæŸ</p>
</blockquote>
<p>é€é<strong>é™£åˆ—</strong>çš„å½¢å¼å‚³å…¥å¤šå€‹ promise å‡½å¼ï¼Œåœ¨å…¨éƒ¨åŸ·è¡Œå®Œæˆå¾Œå›å‚³é™£åˆ—çµæœ</p>
<p><strong>é€™å€‹æ–¹æ³•å¾ˆé©åˆç”¨åœ¨å¤šæ”¯ API è¦ä¸€èµ·åŸ·è¡Œï¼Œä¸¦ç¢ºä¿å…¨éƒ¨å®Œæˆå¾Œæ‰é€²è¡Œå…¶ä»–å·¥ä½œæ™‚ã€‚</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é€™æ˜¯é‡å°ä¸Šä¸€partçš„ resolve, rejectçš„å‡½å¼æ‰€ç·¨å¯«</span></span><br><span class="line"><span class="built_in">Promise</span>.all([promise(<span class="number">1</span>), promise(<span class="number">2</span>), promise(<span class="number">3</span>, <span class="number">3000</span>)])</span><br><span class="line">    .then(<span class="function"><span class="params">success</span> =&gt;</span> <span class="built_in">console</span>.log(success))</span><br></pre></td></tr></table></figure>


<h3 id="Promise-race"><a href="#Promise-race" class="headerlink" title="Promise.race"></a>Promise.race</h3><p>é€éé™£åˆ—çš„å½¢å¼å‚³å…¥å¤šå€‹ promise å‡½å¼ï¼Œ<strong>åœ¨å…¨éƒ¨åŸ·è¡Œå®Œæˆå¾Œå›å‚³å–®ä¸€çµæœï¼Œçµæœç‚ºç¬¬ä¸€å€‹é‹è¡Œå®Œæˆçš„</strong>ï¼Œä»¥ä¸‹ç¯„ä¾‹ä¾†èªªå°±æœƒå›å‚³ promise(1) çš„çµæœ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.all([promise(<span class="number">1</span>), promise(<span class="number">2</span>), promise(<span class="number">3</span>, <span class="number">3000</span>)])</span><br><span class="line">    .then(<span class="function"><span class="params">success</span> =&gt;</span> <span class="built_in">console</span>.log(success))</span><br></pre></td></tr></table></figure>

<p>é©åˆç”¨åœ¨å®Œæ•´æ€§, è€Œä¸æ˜¯é †åºæ€§, å°æ¡ˆå­é©åˆ</p>
<h3 id="Promise-reject-Promise-resolve"><a href="#Promise-reject-Promise-resolve" class="headerlink" title="Promise.reject, Promise.resolve"></a>Promise.reject, Promise.resolve</h3><p>é€™å…©å€‹æ–¹æ³•æ˜¯ç›´æ¥å®šç¾© Promise ç‰©ä»¶å·²ç¶“å®Œæˆçš„ç‹€æ…‹ï¼ˆresolve, rejectï¼‰ï¼Œèˆ‡ new Promise ä¸€æ¨£æœƒç”¢ç”Ÿä¸€å€‹æ–°çš„ Promise ç‰©ä»¶ï¼Œä½†å…¶çµæœæ˜¯å·²ç¶“ç¢ºå®šçš„ï¼Œä»¥ä¸‹æä¾›ç¯„ä¾‹èªªæ˜ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨ Promise.resolve ç”¢ç”Ÿä¸€å€‹æ–°çš„ Promise ç‰©ä»¶ï¼Œæ­¤ç‰©ä»¶å¯ä»¥ä½¿ç”¨ then å–å¾— resolve çš„çµæœã€‚</span></span><br><span class="line"><span class="keyword">var</span> result = <span class="built_in">Promise</span>.resolve(<span class="string">'result'</span>);</span><br><span class="line">result.then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'resolved'</span>, res); <span class="comment">// æˆåŠŸéƒ¨åˆ†å¯ä»¥æ­£ç¢ºæ¥æ”¶çµæœ</span></span><br><span class="line">&#125;, res =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'rejected'</span>, res); <span class="comment">// å¤±æ•—éƒ¨åˆ†ä¸æœƒå–å¾—çµæœ</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>ç°¡å–®ä¾†èªª, å¦‚æœç›´æ¥<code>console.dir(result)</code>, æœƒå¾—åˆ°å¦‚ä¸‹çš„åœ–ç‰‡<br><img src="Promise_resolve.png" alt=""></p>
<p>åœ¨[[PromiseStatus]]è£¡é¢, æ²’æœ‰ä¸Šè¿°æ‰€èªªçš„ä¸‰ç¨®ç‹€æ…‹, ä¸”é€£å€¼ä¹Ÿéƒ½è¢«å®šç¾©å¥½äº†</p>
<h2 id="Await-and-Async"><a href="#Await-and-Async" class="headerlink" title="Await and Async"></a>Await and Async</h2><p>await: ç­‰å¾…<br>async: éåŒæ­¥</p>
<h3 id="Async"><a href="#Async" class="headerlink" title="Async"></a>Async</h3><p>async æœ¬èº«ä¹Ÿæ˜¯é¡ä¼¼ Promiseï¼Œåœ¨æ­£ç¢ºåŸ·è¡Œçš„æƒ…æ³ä¸‹ return æœƒå‚³å› resolved çš„ç‹€æ…‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ then ä¾†æ¥æ”¶æ­£ç¢ºçš„è³‡æ–™ã€‚</p>
<p>åº•ä¸‹ä¾‹å­å¯ä»¥çªºçŸ¥ä¸€äºŒ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸€èˆ¬ä¾†èªªPromiseçš„å¯«æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        resolve(<span class="string">'hello'</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(run2())</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ”¹æˆasyncä»¥å¾Œ</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'hello'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(run())</span><br></pre></td></tr></table></figure>
<p>æŠŠ<code>run()</code>å’Œ<code>run2()</code>, consoleå‡ºä¾†, çµæœä¸€æ¨£, æ‰€ä»¥<code>async</code>æ ¹æœ¬å°±æ˜¯<code>Promise</code>çš„èªæ³•ç³–</p>
<p>å¯ä»¥çœ‹å‡º, returnå›ä¾†çš„æ±è¥¿å°±æ˜¯resolveValue</p>
<p><img src="async.png" alt=""></p>
<p>ä½†å…¶å¯¦é€™æ¨£é‚„ä¸å¤ ç”œ, ç”œæ˜¯ç”œåœ¨await </p>
<h3 id="Await"><a href="#Await" class="headerlink" title="Await"></a>Await</h3><p>Await é¡§åæ€ç¾©å°±æ˜¯ç­‰å¾…ï¼Œåœ¨é€™å€‹ Promise çµæŸå‰å¾Œé¢çš„ç¨‹å¼ç¢¼éƒ½ç„¡æ³•è¢«åŸ·è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'hello'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">walk</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'moto'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">    <span class="comment">// awaitæ˜¯å¹¹å˜›ç”¨çš„? ä»–å¯ä»¥å–ä»£æ‰thenå’Œcatch, å…ˆç­‰runåŸ·è¡Œå®Œå¾Œ, è³¦äºˆåˆ°a, æ¥ä¸‹ä¾†åŸ·è¡Œwalk</span></span><br><span class="line">    <span class="comment">// å…¶å¯¦å°±æŠŠå®ƒæƒ³æˆæ€éº¼åŸ·è¡Œfunctionçš„é †åºé€™æ¨£</span></span><br><span class="line">    <span class="keyword">let</span> a = <span class="keyword">await</span> run()</span><br><span class="line">    <span class="keyword">let</span> b = <span class="keyword">await</span> walk()</span><br><span class="line">    <span class="keyword">let</span> c = <span class="keyword">await</span> run()</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>

<h3 id="éŒ¯èª¤"><a href="#éŒ¯èª¤" class="headerlink" title="éŒ¯èª¤"></a>éŒ¯èª¤</h3><p>å‡ºç¾éŒ¯èª¤äº†æ€éº¼è¾¦? ç”¨try, catchå»æ¥</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 1. ç­‰å¾…runé€™å€‹éåŒæ­¥çš„äº‹ä»¶, å®Œæˆå¾ŒæŠŠçµæœå¯«åœ¨aè£¡é¢</span></span><br><span class="line"><span class="comment">// 2. å¦‚æœéåŒæ­¥å›ä¾†æ˜¯éŒ¯çš„æ€éº¼è¾¦? å‘Šè¨´é›»è…¦å¹«æˆ‘è©¦è©¦çœ‹å•Š</span></span><br><span class="line"><span class="comment">// 3. å¦‚æœéŒ¯èª¤ä¸åštry, catch, ç¨‹å¼ç¢¼æœƒå› æ­¤ä¸­æ–·ä¸‹ä¾†</span></span><br><span class="line"><span class="comment">// 4. å¦‚æœæˆåŠŸå°±å¯«é€²å», å¦‚æœå¤±æ•—ç¨‹å¼ç¢¼å°±æœƒåœä¸‹ä¾†</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'hello'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">failed</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="string">'error'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> a = <span class="keyword">await</span> run()</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> b = <span class="keyword">await</span> failed()</span><br><span class="line">    &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> c = <span class="keyword">await</span> failed()</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å„ªåŒ–å¯«æ³•</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">run2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> result</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        result = <span class="literal">true</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        result = <span class="literal">false</span></span><br><span class="line">    &#125; <span class="keyword">finally</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'finally'</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'xxx'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(run2())</span><br></pre></td></tr></table></figure>




<h2 id="åƒè€ƒæ–‡ç»"><a href="#åƒè€ƒæ–‡ç»" class="headerlink" title="åƒè€ƒæ–‡ç»"></a>åƒè€ƒæ–‡ç»</h2><ul>
<li><p><a href="https://wcc723.github.io/javascript/2017/12/07/javascript-event-queue/" target="_blank" rel="noopener">ä¸€æ¬¡åªèƒ½åšä¸€ä»¶äº‹æƒ…çš„ JavaScript</a></p>
</li>
<li><p><a href="https://wcc723.github.io/development/2020/02/16/all-new-promise/" target="_blank" rel="noopener">JavaScript Promise å…¨ä»‹ç´¹</a></p>
</li>
<li><p><a href="https://www.youtube.com/watch?v=TNTIKEWoD_Q&t=54m50s" target="_blank" rel="noopener">[ Alex å®…å¹¹å˜› ] ğŸ‘¨â€ğŸ’»é€™äº›å¹´ç¶“æ­·éçš„åŒæ­¥éåŒæ­¥ with Tommy</a></p>
</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/javascript/" rel="tag"># javascript</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/maskMap/2020/02/18/map-intro/" rel="prev" title="maskMap-åœ°åœ–å¯¦ä½œ">
      <i class="fa fa-chevron-left"></i> maskMap-åœ°åœ–å¯¦ä½œ
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®éŒ„
        </li>
        <li class="sidebar-nav-overview">
          æœ¬ç«™æ¦‚è¦
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#JSçš„é‹ä½œåŸç†"><span class="nav-number">1.</span> <span class="nav-text">JSçš„é‹ä½œåŸç†</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åè©è§£é‡‹"><span class="nav-number">2.</span> <span class="nav-text">åè©è§£é‡‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Ajax"><span class="nav-number">2.1.</span> <span class="nav-text">Ajax</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Promise"><span class="nav-number">2.2.</span> <span class="nav-text">Promise</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Promise-èˆ‡-Asyncã€Await-æœ‰ä»€éº¼é—œä¿‚ï¼Ÿ"><span class="nav-number">2.3.</span> <span class="nav-text">Promise èˆ‡ Asyncã€Await æœ‰ä»€éº¼é—œä¿‚ï¼Ÿ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Promise-çš„çµæ§‹åŠç‹€æ…‹"><span class="nav-number">3.</span> <span class="nav-text">Promise çš„çµæ§‹åŠç‹€æ…‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#åŸç”Ÿèª¿ç”¨"><span class="nav-number">3.1.</span> <span class="nav-text">åŸç”Ÿèª¿ç”¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å»ºæ§‹å‡½å¼-new-èª¿ç”¨"><span class="nav-number">3.2.</span> <span class="nav-text">å»ºæ§‹å‡½å¼ new èª¿ç”¨</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç‹€æ…‹"><span class="nav-number">4.</span> <span class="nav-text">ç‹€æ…‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ›´æ”¹ç‹€æ…‹çœ‹çœ‹"><span class="nav-number">4.1.</span> <span class="nav-text">æ›´æ”¹ç‹€æ…‹çœ‹çœ‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#then-vs-catch-èˆ‰ä¾‹"><span class="nav-number">4.2.</span> <span class="nav-text">then vs catch èˆ‰ä¾‹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¯¦ä¾‹ä¾†ä¸€ä¸‹"><span class="nav-number">5.</span> <span class="nav-text">å¯¦ä¾‹ä¾†ä¸€ä¸‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ç„¡æ³•ç¢ºå®šcallbackå›å‚³çš„é †åº"><span class="nav-number">5.1.</span> <span class="nav-text">ç„¡æ³•ç¢ºå®šcallbackå›å‚³çš„é †åº</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ”¹æˆcallback"><span class="nav-number">5.2.</span> <span class="nav-text">æ”¹æˆcallback</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ”¹æˆPromise"><span class="nav-number">5.3.</span> <span class="nav-text">æ”¹æˆPromise</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ”¹æˆAsync-amp-Await-å¯«æ³•"><span class="nav-number">5.4.</span> <span class="nav-text">æ”¹æˆAsync &amp; Await å¯«æ³•</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Promise-æ–¹æ³•"><span class="nav-number">6.</span> <span class="nav-text">Promise æ–¹æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Promise-all"><span class="nav-number">6.1.</span> <span class="nav-text">Promise.all</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Promise-race"><span class="nav-number">6.2.</span> <span class="nav-text">Promise.race</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Promise-reject-Promise-resolve"><span class="nav-number">6.3.</span> <span class="nav-text">Promise.reject, Promise.resolve</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Await-and-Async"><span class="nav-number">7.</span> <span class="nav-text">Await and Async</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Async"><span class="nav-number">7.1.</span> <span class="nav-text">Async</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Await"><span class="nav-number">7.2.</span> <span class="nav-text">Await</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#éŒ¯èª¤"><span class="nav-number">7.3.</span> <span class="nav-text">éŒ¯èª¤</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åƒè€ƒæ–‡ç»"><span class="nav-number">8.</span> <span class="nav-text">åƒè€ƒæ–‡ç»</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Norris</p>
  <div class="site-description" itemprop="description">æ¯å¤©éƒ½è¦é€²æ­¥ä¸€é»é»</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">æ–‡ç« </span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">åˆ†é¡</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">æ¨™ç±¤</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/fan630" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;fan630" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:norriswu266@gmail.com" title="E-Mail â†’ mailto:norriswu266@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Norris</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://msgboard.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "http://fan630.github.io/uncategorized/2020/02/20/Promise-you-need-to-know/";
    this.page.identifier = "uncategorized/2020/02/20/Promise-you-need-to-know/";
    this.page.title = "ä¸€æ¬¡ææ‡‚Promise";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://msgboard.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
